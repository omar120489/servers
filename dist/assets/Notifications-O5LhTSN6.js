import{importShared as j}from"./__federation_fn_import-CJIdJiQv.js";import{j as e}from"./useForkRef-BC7kqYKT.js";import{A as O}from"./AppPage-CfPA9hni.js";import{u as U,a as Y,b as H,I as J,i as X}from"./useNotificationPreferences-CXfu0G2v.js";import{c as C}from"./createReactComponent-RpECKCBP.js";import{I as q}from"./IconChevronDown-CoYIojlZ.js";import{I as G}from"./IconX-AJwUASz1.js";import{I as K}from"./IconCheck-DdeqxniZ.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M9.346 5.353c.21 -.129 .428 -.246 .654 -.353a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3m-1 3h-13a4 4 0 0 0 2 -3v-3a6.996 6.996 0 0 1 1.273 -3.707",key:"svg-0"}],["path",{d:"M9 17v1a3 3 0 0 0 6 0v-1",key:"svg-1"}],["path",{d:"M3 3l18 18",key:"svg-2"}]],V=C("outline","bell-off","BellOff",Q);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]],ee=C("outline","external-link","ExternalLink",Z),{memo:te}=await j("react"),{Accordion:se,AccordionDetails:ne,AccordionSummary:ae,Box:n,Button:g,Chip:f,Divider:M,FormControl:ie,FormControlLabel:le,IconButton:w,List:oe,ListItem:re,ListItemButton:ce,MenuItem:u,Pagination:de,Select:xe,Switch:he,Tooltip:k,Typography:c}=await j("@mui/material"),{useNavigate:A}=await j("react-router-dom");function pe(t){const a=new Date(t),s=new Date().getTime()-a.getTime(),l=Math.floor(s/6e4);if(l<1)return"Just now";if(l<60)return`${l} minute${l>1?"s":""} ago`;const o=Math.floor(l/60);if(o<24)return`${o} hour${o>1?"s":""} ago`;const r=Math.floor(o/24);return r<7?`${r} day${r>1?"s":""} ago`:a.toLocaleDateString()}function me(t){switch(t){case"success":return"success";case"error":return"error";case"warning":return"warning";case"info":return"info";default:return"default"}}function I(t,a){if(!t||!a)return null;const s={deal:"/deals",lead:"/leads",contact:"/contacts",company:"/companies"}[t.toLowerCase()];return s?`${s}/${a}`:null}function ue({notification:t,onMarkAsRead:a,onMarkAsUnread:i}){const s=A(),l=X(t.createdAt),o=()=>{t.isRead||a(t.id)},r=x=>{x.stopPropagation(),t.isRead?i(t.id):a(t.id)},h=x=>{x.stopPropagation();const m=I(t.entityType,t.entityId);m&&s(m)},d=I(t.entityType,t.entityId);return e.jsxs(e.Fragment,{children:[e.jsxs(re,{disablePadding:!0,sx:{position:"relative"},children:[e.jsx(ce,{onClick:o,sx:{py:2,pr:10},children:e.jsx(n,{sx:{display:"flex",flexDirection:"column",width:"100%",gap:1},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[!t.isRead&&e.jsx(n,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"primary.main",flexShrink:0}}),e.jsxs(n,{sx:{flex:1},children:[e.jsx(c,{variant:"subtitle1",sx:{fontWeight:t.isRead?400:600,color:t.isRead?"text.secondary":"text.primary"},children:t.title}),t.message&&e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:t.message}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:[e.jsx(c,{variant:"caption",color:"text.secondary",children:pe(t.createdAt)}),!t.isRead&&e.jsx(f,{label:"Unread",size:"small",sx:{height:20,fontSize:"0.7rem",bgcolor:"#ffebee",color:"#d32f2f",fontWeight:500}}),l&&e.jsx(f,{label:"New",size:"small",sx:{height:20,fontSize:"0.7rem",bgcolor:"#fff3e0",color:"#e65100",fontWeight:500}})]})]}),t.type&&e.jsx(f,{label:t.type,color:me(t.type),variant:"outlined",size:"small",sx:{textTransform:"capitalize"}})]})})}),e.jsxs(n,{sx:{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",display:"flex",gap:.5},children:[e.jsx(k,{title:t.isRead?"Mark as unread":"Mark as read",children:e.jsx(w,{size:"small",onClick:r,children:t.isRead?e.jsx(G,{size:18}):e.jsx(K,{size:18})})}),d&&e.jsx(k,{title:`Open ${t.entityType||"entity"}`,children:e.jsx(w,{size:"small",onClick:h,children:e.jsx(ee,{size:18})})})]})]}),e.jsx(M,{})]})}const fe=te(ue,(t,a)=>{const i=t.notification,s=a.notification;return i.id===s.id&&i.isRead===s.isRead&&i.createdAt===s.createdAt&&i.title===s.title&&i.message===s.message&&(i.entityType??"")===(s.entityType??"")&&(i.entityId??"")===(s.entityId??"")});function ge(){const{mutedTypes:t,isMuted:a,toggleMute:i,muteAll:s,unmuteAll:l}=H(),o=[{type:"comment",label:"Comments"},{type:"attachment",label:"Attachments"},{type:"notification",label:"System Notifications"},{type:"email",label:"Emails"},{type:"mention",label:"Mentions"}],r=t.length===o.length,h=t.length===0;return e.jsxs(se,{children:[e.jsx(ae,{expandIcon:e.jsx(q,{}),children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(J,{size:20}),e.jsx(c,{variant:"subtitle1",children:"Notification Preferences"})]})}),e.jsx(ne,{children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(c,{variant:"body2",color:"text.secondary",children:"Choose which types of notifications you want to receive as toasts."}),e.jsx(n,{sx:{display:"flex",flexDirection:"column",gap:1},children:o.map(({type:d,label:x})=>e.jsx(le,{control:e.jsx(he,{checked:!a(d),onChange:()=>i(d)}),label:x},d))}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(g,{size:"small",variant:"outlined",onClick:l,disabled:h,children:"Enable All"}),e.jsx(g,{size:"small",variant:"outlined",color:"secondary",onClick:s,disabled:r,children:"Disable All"})]})]})})]})}function Me(){const t=A(),{paginatedNotifications:a,filteredNotifications:i,unreadCount:s,loading:l,error:o,page:r,totalPages:h,filter:d,markAsRead:x,markAsUnread:m,markAllAsRead:N,setPage:R,setFilter:z,refresh:T}=U(),P=()=>{T()},S=a.length>0,$=(p,y)=>{R(y)},D=p=>{const y=p.target.value;z(y)},L=()=>{N()},B=s>1?"s":"",v=s>0?`${s} unread notification${B}`:"All caught up!",b=i.length,F=e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2,width:"100%"},children:[e.jsx(ge,{}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:2},children:[e.jsx(ie,{size:"small",sx:{minWidth:220},children:e.jsxs(xe,{"aria-label":"Filter notifications",value:d,onChange:D,displayEmpty:!0,sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center",gap:1,py:1}},children:[e.jsx(u,{value:"all",children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:["All Notifications",b>0&&e.jsx(f,{label:`${b}`.padStart(2,"0"),size:"small",sx:{height:20,minWidth:28,bgcolor:"#ff9800",color:"white",fontWeight:600,"& .MuiChip-label":{px:1}}})]})}),e.jsx(u,{value:"new",children:"New"}),e.jsx(u,{value:"unread",children:"Unread"}),e.jsx(u,{value:"other",children:"Other"})]})}),e.jsx(n,{})]}),e.jsx(M,{})]}),E=s>0?e.jsx(g,{variant:"text",size:"small",onClick:L,children:"Mark all as read"}):null,W=e.jsxs(n,{sx:{py:8,textAlign:"center"},children:[e.jsx(V,{size:64,stroke:1.5,style:{opacity:.3}}),e.jsx(c,{variant:"h4",color:"text.secondary",sx:{mt:2},children:"No notifications yet"}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"You're all caught up! We'll notify you when something new happens."}),e.jsx(g,{variant:"contained",sx:{mt:2},onClick:()=>{t("/leads/new")},children:"Create a lead"})]}),_=h>1?e.jsx(de,{count:h,page:r,onChange:$,color:"primary",showFirstButton:!0,showLastButton:!0}):void 0;return e.jsxs(O,{title:"Notifications",toolbar:F,actions:E,loading:l,error:o,empty:!S,onRetry:P,emptySlot:W,footer:_,ariaLabel:"Notifications center",children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,position:"relative",mb:2},children:[e.jsx(Y,{size:20}),e.jsx(c,{variant:"caption",color:"text.secondary",children:v}),e.jsx(n,{sx:{position:"absolute",width:1,height:1,overflow:"hidden",clip:"rect(0 0 0 0)"},"aria-live":"polite",children:v})]}),e.jsx(oe,{sx:{p:0},children:a.map(p=>e.jsx(fe,{notification:p,onMarkAsRead:x,onMarkAsUnread:m},p.id))})]})}export{Me as default};
//# sourceMappingURL=Notifications-O5LhTSN6.js.map
