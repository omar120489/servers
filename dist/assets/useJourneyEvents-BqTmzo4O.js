import{importShared as U}from"./__federation_fn_import-CJIdJiQv.js";import{j as t}from"./useForkRef-BC7kqYKT.js";import{c as W}from"./createSvgIcon-J8zf_NKi.js";import{a as ne,b as de,e as Ie,c as Ae,d as ue}from"./axios-CKLPSsiI.js";import{u as re}from"./useWebSocketEvents-BBdHp8NF.js";import{C as me,a as he}from"./CardContent-CBXeKjeK.js";import{C as pe}from"./CardHeader-DMDHtVKo.js";import{T as R}from"./Tooltip-L_uP0b9W.js";import{I as B}from"./IconButton-BEyrMm9G.js";import{C as T,d as ye}from"./Button-Bgis-uOM.js";import{D as O}from"./Divider-DT_KIT_t.js";import{S as ee}from"./Stack-B5BVBH1D.js";import{B as L}from"./Box-DmbfI6Tx.js";import{T as z}from"./Typography-DFd_zA1D.js";import{L as Se}from"./LinearProgress-BaGLU8ch.js";import{A as te}from"./Alert-C9XT2yne.js";import{C as fe,L as ge}from"./ListItem-BQBfUv4z.js";import{L as xe,T as $e}from"./TextField-HqD_g_zo.js";import{L as ve}from"./ListItemText-CvIJbpEN.js";import{a as ke,I as Me}from"./IconFileInvoice-Br9qFcVt.js";import{I as Te}from"./IconCheck-DdeqxniZ.js";import{c as H}from"./createReactComponent-RpECKCBP.js";import{I as Ee}from"./IconX-AJwUASz1.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M9 12h6",key:"svg-1"}],["path",{d:"M12 9v6",key:"svg-2"}]],Le=H("outline","circle-plus","CirclePlus",De);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M8 9h8",key:"svg-0"}],["path",{d:"M8 13h6",key:"svg-1"}],["path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z",key:"svg-2"}]],Ue=H("outline","message","Message",ze);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M15 4l4 0l0 4",key:"svg-0"}],["path",{d:"M14.75 9.25l4.25 -5.25",key:"svg-1"}],["path",{d:"M5 19l4 -4",key:"svg-2"}],["path",{d:"M15 19l4 0l0 -4",key:"svg-3"}],["path",{d:"M5 5l14 14",key:"svg-4"}]],Pe=H("outline","switch","Switch",Fe);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M8 21l8 0",key:"svg-0"}],["path",{d:"M12 17l0 4",key:"svg-1"}],["path",{d:"M7 4l10 0",key:"svg-2"}],["path",{d:"M17 4v8a5 5 0 0 1 -10 0v-8",key:"svg-3"}],["path",{d:"M5 9m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-4"}],["path",{d:"M19 9m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-5"}]],Be=H("outline","trophy","Trophy",Re);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4",key:"svg-1"}],["path",{d:"M15 19l2 2l4 -4",key:"svg-2"}]],Ne=H("outline","user-check","UserCheck",He),Je=W(t.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M19 18H6c-2.21 0-4-1.79-4-4 0-2.05 1.53-3.76 3.56-3.97l1.07-.11.5-.95C8.08 7.14 9.94 6 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5 1.53.11c1.56.1 2.78 1.41 2.78 2.96 0 1.65-1.35 3-3 3M8 13h2.55v3h2.9v-3H16l-4-4z"})),je=W(t.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"})),Ve=W(t.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zm-8 2V5h2v6h1.17L12 13.17 9.83 11zm-6 7h14v2H5z"})),be=W(t.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),ae="/api/v1/attachments";function we(e){return{id:e.id,filename:e.filename,fileSize:e.file_size,contentType:e.content_type,entityType:e.entity_type,entityId:e.entity_id,path:e.path,createdAt:e.created_at}}function qe(){const e="https://api.example.com/api/v1";return e.endsWith("/")?e.slice(0,-1):e}function Ce(e){const n=qe(),r=e.replace(/^\/+/,"");return`${n}/api/v1/attachments/download/${r}`}async function Oe(e,n){return(await ne(`${ae}/${e}/${n}`)).map(we)}async function We(e){const n=new FormData;n.append("file",e.file),n.append("entity_type",e.entityType),n.append("entity_id",String(e.entityId));const{data:r}=await Ie.post(ae,n,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a=>{if(!e.onUploadProgress||!a.total)return;const i=Math.round(a.loaded/a.total*100);e.onUploadProgress(i)}});return we(r)}async function Ge(e){await de(`${ae}/${e}`)}const Y={listAttachments:Oe,uploadAttachment:We,deleteAttachment:Ge,buildAttachmentDownloadUrl:Ce},{useCallback:J,useEffect:K,useMemo:Ye,useState:E}=await U("react");function Ke(e){const{entityType:n,entityId:r,autoLoad:a=!0}=e,[i,s]=E([]),[y,h]=E(!1),[u,C]=E(!1),[f,m]=E(null),[S,I]=E(null),[A,$]=E(new Set),g=Ye(()=>n&&r!==void 0,[n,r]),{subscribe:k}=re(),o=J(async()=>{if(!g){s([]);return}h(!0);try{const d=await Y.listAttachments(n,r);s(d),I(null)}catch(d){throw I(d),d}finally{h(!1)}},[r,n,g]);K(()=>{!a||!g||o()},[a,g,o]);const v=J(async()=>{await o()},[o]),p=J(async d=>{if(!g)throw new Error("Cannot upload attachment without a valid entityType/entityId");C(!0),m(0);try{const w=await Y.uploadAttachment({entityType:n,entityId:r,file:d,onUploadProgress:x=>{m(x)}});return s(x=>[w,...x]),m(null),w}catch(w){throw m(null),w}finally{C(!1)}},[r,n,g]),_=J(async d=>{$(w=>{const x=new Set(w);return x.add(d),x});try{await Y.deleteAttachment(d),s(w=>w.filter(x=>x.id!==d))}finally{$(w=>{const x=new Set(w);return x.delete(d),x})}},[]);return K(()=>g?k("attachment:uploaded",w=>{const x=w;x.entityType===n&&x.entityId===r&&v().catch(F=>{console.error("[useAttachments] Failed to refresh on attachment:uploaded event:",F)})}):void 0,[k,n,r,g,v]),K(()=>g?k("attachment:deleted",w=>{const{entityType:x,entityId:F}=w;x===n&&F===r&&v().catch(c=>{console.error("[useAttachments] Failed to refresh on attachment:deleted event:",c)})}):void 0,[k,n,r,g,v]),{attachments:i,loading:y,error:S,uploading:u,uploadProgress:f,deletingIds:A,refresh:v,uploadAttachment:p,deleteAttachment:_}}const{useCallback:X,useMemo:Xe,useRef:Qe,useState:Ze}=await U("react");function et(e){if(!e||Number.isNaN(e))return"—";if(e<1024)return`${e} B`;const n=["KB","MB","GB","TB"];let r=e/1024,a=0;for(;r>=1024&&a<n.length-1;)r/=1024,a+=1;return`${r.toFixed(1)} ${n[a]}`}function tt(e){try{return new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(e))}catch{return e}}function Kt({entityType:e,entityId:n,title:r="Attachments",accept:a}){const i=Qe(null),[s,y]=Ze(null),{attachments:h,loading:u,uploading:C,uploadProgress:f,deletingIds:m,error:S,refresh:I,uploadAttachment:A,deleteAttachment:$}=Ke({entityType:e,entityId:n}),g=Xe(()=>typeof f=="number"&&f>0&&f<100,[f]),k=X(async p=>{const _=p.target.files?.[0];if(_)try{y(null),await A(_)}catch(d){y(d instanceof Error?d.message:"Unable to upload file.")}finally{p.target.value=""}},[A]),o=X(async p=>{try{y(null),await $(p.id)}catch(_){y(_ instanceof Error?_.message:"Unable to delete file.")}},[$]),v=X(()=>{i.current?.click()},[]);return t.jsxs(me,{variant:"outlined",children:[t.jsx(pe,{title:r,action:t.jsx(R,{title:"Refresh list",children:t.jsx("span",{children:t.jsx(B,{onClick:()=>void I(),disabled:u,children:u?t.jsx(T,{size:20}):t.jsx(be,{fontSize:"small"})})})})}),t.jsx(O,{}),t.jsx(he,{children:t.jsxs(ee,{spacing:2,children:[t.jsx("input",{type:"file",ref:i,hidden:!0,accept:a,onChange:p=>void k(p)}),t.jsx(ye,{variant:"outlined",startIcon:t.jsx(Je,{}),onClick:v,disabled:C,children:C?"Uploading…":"Upload File"}),g&&t.jsxs(L,{children:[t.jsxs(z,{variant:"caption",color:"text.secondary",children:["Uploading… ",f,"%"]}),t.jsx(Se,{variant:"determinate",value:f??0,sx:{mt:1}})]}),(S||s)&&t.jsx(te,{severity:"error",children:s??"Unable to load attachments."})]})}),t.jsx(O,{}),t.jsxs(fe,{disableSpacing:!0,sx:{flexDirection:"column",alignItems:"stretch",p:0},children:[u&&t.jsx(L,{display:"flex",justifyContent:"center",py:3,children:t.jsx(T,{size:24})}),!u&&h.length===0&&t.jsx(L,{px:3,py:4,children:t.jsx(z,{variant:"body2",color:"text.secondary",textAlign:"center",children:"No attachments yet."})}),!u&&h.length>0&&t.jsx(xe,{sx:{width:"100%"},children:h.map(p=>{const _=Ce(p.path);return t.jsx(ge,{secondaryAction:t.jsxs(ee,{direction:"row",spacing:1,children:[t.jsx(R,{title:"Download",children:t.jsx(B,{component:"a",href:_,target:"_blank",rel:"noreferrer noopener",children:t.jsx(Ve,{fontSize:"small"})})}),t.jsx(R,{title:"Delete",children:t.jsx("span",{children:t.jsx(B,{onClick:()=>void o(p),disabled:m.has(p.id),children:m.has(p.id)?t.jsx(T,{size:20}):t.jsx(je,{fontSize:"small"})})})})]}),children:t.jsx(ve,{primary:p.filename,secondary:t.jsxs(z,{variant:"caption",color:"text.secondary",children:[et(p.fileSize)," • ",tt(p.createdAt)]})})},p.id)})})]})]})}const G="/api/v1/comments";function se(e){return{id:e.id,entityType:e.entity_type,entityId:e.entity_id,content:e.content,mentions:e.mentions,authorId:e.author_id,createdAt:e.created_at,updatedAt:e.updated_at}}function nt(e){return{entity_type:e.entityType,entity_id:String(e.entityId),content:e.content,mentions:e.mentions}}function rt(e){return{content:e.content,mentions:e.mentions}}async function at(e){const n=await ne(G,{params:{entity_type:e.entityType,entity_id:e.entityId}});return{items:n.items.map(se),total:n.total}}async function st(e){const n=await ue(G,nt(e));return se(n)}async function ot(e,n){const r=await Ae(`${G}/${e}`,rt(n));return se(r)}async function it(e){await de(`${G}/${e}`)}const V={listComments:at,createComment:st,updateComment:ot,deleteComment:it},{useCallback:D,useEffect:q,useMemo:ct,useState:M}=await U("react");function lt(e){const{entityType:n,entityId:r,autoLoad:a=!0}=e,[i,s]=M([]),[y,h]=M(0),[u,C]=M(!1),[f,m]=M(null),[S,I]=M(!1),[A,$]=M(new Set),[g,k]=M(new Set),o=ct(()=>n&&r!==void 0,[n,r]),{subscribe:v}=re(),p=D(c=>{s(c.items),h(c.total)},[]),_=D(async()=>{if(!o){s([]),h(0);return}C(!0);try{const c=await V.listComments({entityType:n,entityId:r});p(c),m(null)}catch(c){throw m(c),c}finally{C(!1)}},[n,r,p,o]);q(()=>{!a||!o||_()},[a,o,_]);const d=D(async()=>{await _()},[_]),w=D(async c=>{if(!o)throw new Error("Cannot create comment without a valid entityType/entityId");I(!0);try{const j={entityType:n,entityId:r,content:c.content,mentions:c.mentions},l=await V.createComment(j);return s(b=>[l,...b]),h(b=>b+1),l}finally{I(!1)}},[r,n,o]),x=D(async(c,j)=>{$(l=>{const b=new Set(l);return b.add(c),b});try{const l=await V.updateComment(c,j);return s(b=>b.map(N=>N.id===c?l:N)),l}finally{$(l=>{const b=new Set(l);return b.delete(c),b})}},[]),F=D(async c=>{k(j=>{const l=new Set(j);return l.add(c),l});try{await V.deleteComment(c),s(j=>j.filter(l=>l.id!==c)),h(j=>Math.max(j-1,0))}finally{k(j=>{const l=new Set(j);return l.delete(c),l})}},[]);return q(()=>o?v("comment:new",j=>{const l=j;l.entityType===n&&l.entityId===r&&d().catch(b=>{console.error("[useComments] Failed to refresh on comment:new event:",b)})}):void 0,[v,n,r,o,d]),q(()=>o?v("comment:updated",j=>{const l=j;l.entityType===n&&l.entityId===r&&d().catch(b=>{console.error("[useComments] Failed to refresh on comment:updated event:",b)})}):void 0,[v,n,r,o,d]),q(()=>o?v("comment:deleted",j=>{const{entityType:l,entityId:b}=j;l===n&&b===r&&d().catch(N=>{console.error("[useComments] Failed to refresh on comment:deleted event:",N)})}):void 0,[v,n,r,o,d]),{comments:i,total:y,loading:u,error:f,isCreating:S,updatingIds:A,deletingIds:g,refresh:d,createComment:w,updateComment:x,deleteComment:F}}const{useCallback:oe,useMemo:dt,useState:ie}=await U("react");function ut(e){try{return new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(e))}catch{return e}}function Xt({entityType:e,entityId:n,title:r="Comments"}){const[a,i]=ie(""),[s,y]=ie(null),{comments:h,loading:u,error:C,isCreating:f,deletingIds:m,refresh:S,createComment:I,deleteComment:A}=lt({entityType:e,entityId:n}),$=dt(()=>a.trim().length>0&&!f,[a,f]),g=oe(async()=>{if(a.trim())try{y(null),await I({content:a.trim()}),i("")}catch(o){y(o instanceof Error?o.message:"Unable to post comment.")}},[I,a]),k=oe(async o=>{try{await A(o)}catch(v){y(v instanceof Error?v.message:"Unable to delete comment.")}},[A]);return t.jsxs(me,{variant:"outlined",children:[t.jsx(pe,{title:r,action:t.jsx(R,{title:"Refresh",children:t.jsx("span",{children:t.jsx(B,{onClick:()=>void S(),disabled:u,children:u?t.jsx(T,{size:20}):t.jsx(be,{fontSize:"small"})})})})}),t.jsx(O,{}),t.jsx(he,{children:t.jsxs(ee,{spacing:2,children:[t.jsx($e,{label:"Add a comment",placeholder:"Share an update...",value:a,onChange:o=>i(o.target.value),multiline:!0,minRows:3,disabled:f}),t.jsx(L,{display:"flex",justifyContent:"flex-end",children:t.jsx(ye,{variant:"contained",onClick:()=>void g(),disabled:!$,children:f?t.jsx(T,{size:20}):"Post"})}),s&&t.jsx(te,{severity:"error",children:s}),C&&!s&&t.jsx(te,{severity:"error",children:"Unable to load comments. Please try again."})]})}),t.jsx(O,{}),t.jsxs(fe,{disableSpacing:!0,sx:{flexDirection:"column",alignItems:"stretch",p:0},children:[u&&t.jsx(L,{display:"flex",justifyContent:"center",py:3,children:t.jsx(T,{size:24})}),!u&&h.length===0&&t.jsx(L,{px:3,py:4,children:t.jsx(z,{variant:"body2",color:"text.secondary",textAlign:"center",children:"No comments yet. Start the conversation above."})}),!u&&h.length>0&&t.jsx(xe,{sx:{width:"100%"},children:h.map(o=>t.jsx(ge,{alignItems:"flex-start",secondaryAction:t.jsx(R,{title:"Delete comment",children:t.jsx("span",{children:t.jsx(B,{edge:"end","aria-label":"delete",onClick:()=>void k(o.id),disabled:m.has(o.id),children:m.has(o.id)?t.jsx(T,{size:20}):t.jsx(je,{fontSize:"small"})})})}),children:t.jsx(ve,{primary:t.jsx(z,{variant:"body1",children:o.content}),secondary:t.jsx(z,{variant:"caption",color:"text.secondary",children:ut(o.createdAt)})})},o.id))})]})]})}const{Alert:mt,Avatar:ht,Box:ce,Button:pt,CircularProgress:yt,List:ft,ListItem:gt,ListItemAvatar:xt,ListItemText:vt,Typography:P}=await U("@mui/material");function jt(e){switch(e){case"status_change":return{icon:Pe,color:"primary.main",bgcolor:"primary.light"};case"deal_won":return{icon:Be,color:"success.main",bgcolor:"success.light"};case"deal_lost":return{icon:Ee,color:"error.main",bgcolor:"error.light"};case"first_quote_sent":return{icon:Me,color:"secondary.main",bgcolor:"secondary.light"};case"message_sent":return{icon:Ue,color:"info.main",bgcolor:"info.light"};case"agent_handoff":return{icon:Ne,color:"warning.main",bgcolor:"warning.light"};case"deal_created":case"lead_created":return{icon:Le,color:"primary.main",bgcolor:"primary.light"};case"lead_converted":return{icon:Te,color:"success.main",bgcolor:"success.light"};default:return{icon:ke,color:"text.secondary",bgcolor:"action.hover"}}}function bt(e){const{type:n,payload:r}=e;switch(n){case"status_change":return r?.from&&r?.to?`Status changed from ${r.from} to ${r.to}`:"Status changed";case"deal_won":return"Deal marked as Won";case"deal_lost":return r?.reason?`Deal marked as Lost: ${r.reason}`:"Deal marked as Lost";case"first_quote_sent":return"First quote sent to customer";case"message_sent":return r?.subject?`Message sent: ${r.subject}`:"Message sent";case"agent_handoff":return r?.agent?`Handed off to ${r.agent}`:"Handed off to another agent";case"deal_created":return"Deal created";case"lead_created":return"Lead created";case"lead_converted":return"Lead converted to deal";default:return n.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}}function wt(e){const{payload:n}=e;return n?n.description?String(n.description):n.notes?String(n.notes):null:null}function Ct(e){const n=new Date(e),r=new Date,a=r.getTime()-n.getTime(),i=Math.floor(a/6e4),s=Math.floor(a/36e5),y=Math.floor(a/864e5);return i<1?"Just now":i<60?`${i}m ago`:s<24?`${s}h ago`:y<7?`${y}d ago`:n.toLocaleDateString(void 0,{month:"short",day:"numeric",year:n.getFullYear()!==r.getFullYear()?"numeric":void 0})}function Qt({events:e,loading:n,error:r,onRetry:a}){return n?t.jsx(ce,{sx:{display:"flex",justifyContent:"center",py:6},children:t.jsx(yt,{})}):r?t.jsxs(mt,{severity:"error",sx:{mb:2},children:[t.jsx(P,{variant:"body2",sx:{mb:1},children:"Failed to load activity timeline. Please try again."}),a&&t.jsx(pt,{size:"small",variant:"outlined",onClick:a,children:"Retry"})]}):e.length===0?t.jsx(ce,{sx:{py:6,textAlign:"center"},children:t.jsx(P,{variant:"body2",color:"text.secondary",children:"No activity yet. Events will appear here as actions are taken."})}):t.jsx(ft,{sx:{width:"100%",bgcolor:"background.paper"},children:e.map(i=>{const{icon:s,color:y,bgcolor:h}=jt(i.type),u=bt(i),C=wt(i),f=Ct(i.occurredAt);return t.jsxs(gt,{alignItems:"flex-start",sx:{borderLeft:2,borderColor:"divider","&:first-of-type":{borderTopLeftRadius:1,borderTopRightRadius:1},"&:last-of-type":{borderBottomLeftRadius:1,borderBottomRightRadius:1}},children:[t.jsx(xt,{children:t.jsx(ht,{sx:{bgcolor:h,color:y},children:t.jsx(s,{size:20})})}),t.jsx(vt,{primary:t.jsx(P,{variant:"subtitle2",component:"span",children:u}),secondary:t.jsxs(t.Fragment,{children:[C&&t.jsx(P,{variant:"body2",color:"text.secondary",sx:{mt:.5,mb:.5},children:C}),t.jsx(P,{variant:"caption",color:"text.secondary",children:f})]})})]},i.id)})})}const _e="/api/v1/journey-events";async function _t(e,n,r){const a={entity_type:e,entity_id:n,...r},i=await ne(_e,{params:a});return{items:i.items.map(s=>({id:s.id,entityType:s.entity_type,entityId:s.entity_id,type:s.type,payload:s.payload,occurredAt:s.occurred_at,createdAt:s.created_at,updatedAt:s.updated_at||s.created_at})),total:i.total}}async function It(e){const n={entity_type:e.entityType,entity_id:e.entityId,type:e.type,payload:e.payload,occurred_at:e.occurredAt},r=await ue(_e,n);return{id:r.id,entityType:r.entity_type,entityId:r.entity_id,type:r.type,payload:r.payload,occurredAt:r.occurred_at,createdAt:r.created_at,updatedAt:r.updated_at||r.created_at}}const le={listJourneyEvents:_t,createJourneyEvent:It},{useCallback:Q,useEffect:At,useState:Z}=await U("react");function Zt({entityType:e,entityId:n}){const[r,a]=Z([]),[i,s]=Z(!0),[y,h]=Z(null),u=Q(async()=>{if(n){s(!0),h(null);try{const m=await le.listJourneyEvents(e,n);a(m.items)}catch(m){h(m instanceof Error?m:new Error("Failed to load journey events")),console.error("[useJourneyEvents] Load failed:",m)}finally{s(!1)}}},[e,n]);At(()=>{u()},[u]),re();const C=Q(async()=>{await u()},[u]),f=Q(async m=>{try{const S={entityType:e,entityId:n,...m},I=await le.createJourneyEvent(S);a(A=>A.some(g=>g.id===I.id)?A:[I,...A])}catch(S){throw console.error("[useJourneyEvents] Failed to add event:",S),S}},[e,n]);return{events:r,loading:i,error:y,refresh:C,addEvent:f}}export{Kt as A,Xt as C,Qt as a,Zt as u};
//# sourceMappingURL=useJourneyEvents-BqTmzo4O.js.map
