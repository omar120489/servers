import{importShared as b}from"./__federation_fn_import-CJIdJiQv.js";import{j as e}from"./useForkRef-BC7kqYKT.js";import{i as D}from"./axios-CKLPSsiI.js";import{u as B,C as E,A as P,a as S}from"./useJourneyEvents-BqTmzo4O.js";import{M as I}from"./MainCard-BRoTQIrC.js";import{l as N}from"./leads-BgdtH0Oz.js";import{G as r}from"./GridLegacy-DgbSh-o7.js";import{T as s}from"./Typography-DFd_zA1D.js";import{C as F}from"./Chip-clCeHopq.js";import{a as M,T as x}from"./Tab-DFFX6k-o.js";import{B as o}from"./Box-DmbfI6Tx.js";import{C as $,d as h}from"./Button-Bgis-uOM.js";import{A as q}from"./Alert-C9XT2yne.js";const{useCallback:W,useEffect:z,useMemo:v,useState:y}=await b("react"),{useNavigate:R,useParams:G}=await b("react-router-dom");function U(t){return t?new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric"}).format(new Date(t)):"—"}function J(t){return t==null||Number.isNaN(t)?"—":`${Math.round(t)}%`}function O(t){if(!t)return!1;const l=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[089abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/,a=/^\d+$/;return l.test(t)||a.test(t)}function ne(){const{id:t}=G(),l=R(),[a,g]=y(null),[m,f]=y(!0),[i,d]=y(null),[c,C]=y("summary"),u=B({entityType:"lead",entityId:t||""}),j=W(async()=>{if(!O(t)){d({kind:"not-found",message:"The requested lead could not be found."}),f(!1);return}f(!0);try{const n=await N.getLead(t);g(n),d(null)}catch(n){D(n)?n.response?.status===404?d({kind:"not-found",message:"The requested lead could not be found."}):d({kind:"network",message:n.response?.data?.message??"We could not load this lead. Please try again in a moment."}):d({kind:"network",message:"We could not load this lead. Please try again in a moment."})}finally{f(!1)}},[t]);z(()=>{j()},[j]);const p=v(()=>{switch(a?.status?.toLowerCase()){case"converted":case"qualified":return"success";case"unqualified":return"error";case"working":case"contacted":return"info";default:return"default"}},[a?.status]),A=v(()=>a?e.jsxs(r,{container:!0,spacing:2,children:[e.jsxs(r,{xs:12,sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsxs(s,{variant:"h4",children:[a.firstName," ",a.lastName]}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["Lead ID: ",a.id]})]}),e.jsxs(r,{xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Email"}),e.jsx(s,{variant:"body1",children:a.email})]}),e.jsxs(r,{xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Phone"}),e.jsx(s,{variant:"body1",children:a.phone??"—"})]}),e.jsxs(r,{xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Company"}),e.jsx(s,{variant:"body1",children:a.company??"—"})]}),e.jsxs(r,{xs:12,md:6,sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Status"}),e.jsx(F,{label:a.status??"—",color:p,size:"small"})]}),e.jsxs(r,{xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Source"}),e.jsx(s,{variant:"body1",children:a.source??"—"})]}),e.jsxs(r,{xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Lead Score"}),e.jsx(s,{variant:"body1",children:J(a.score)})]}),e.jsxs(r,{xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Owner"}),e.jsx(s,{variant:"body1",children:a.ownerId})]}),e.jsxs(r,{xs:12,md:6,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Updated At"}),e.jsx(s,{variant:"body1",children:U(a.updatedAt)})]}),e.jsxs(r,{xs:12,children:[e.jsx(s,{variant:"subtitle2",color:"text.secondary",children:"Notes"}),e.jsx(s,{variant:"body1",children:a.notes??"—"})]})]}):null,[a,p]),k=e.jsx(o,{sx:{p:3},children:e.jsx(S,{events:u.events,loading:u.loading,error:u.error,onRetry:u.refresh})}),w=!t,T=!t;return e.jsxs(I,{title:"Lead Details",secondary:e.jsxs(o,{sx:{display:"flex",gap:1},children:[e.jsx(h,{variant:"outlined",onClick:()=>l(-1),children:"Back"}),t&&e.jsx(h,{variant:"contained",color:"secondary",onClick:()=>l(`/leads/${t}/edit`),children:"Edit Lead"})]}),children:[e.jsxs(M,{value:c,onChange:(n,L)=>C(L),variant:"scrollable",allowScrollButtonsMobile:!0,sx:{borderBottom:n=>`1px solid ${n.palette.divider}`,mb:2},children:[e.jsx(x,{label:"Summary",value:"summary"}),e.jsx(x,{label:"Activity",value:"activity"}),e.jsx(x,{label:"Comments",value:"comments",disabled:w}),e.jsx(x,{label:"Attachments",value:"attachments",disabled:T})]}),m&&e.jsx(o,{sx:{display:"flex",justifyContent:"center",py:6},children:e.jsx($,{})}),!m&&i&&e.jsxs(q,{severity:i.kind==="network"?"error":"warning",children:[e.jsx(s,{variant:"body2",sx:{mb:1},children:i.message}),e.jsxs(o,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[i.kind==="network"&&e.jsx(h,{size:"small",onClick:()=>void j(),variant:"outlined",children:"Retry"}),e.jsx(h,{size:"small",variant:"contained",onClick:()=>l("/leads"),children:"Back to Leads"})]})]}),!m&&!i&&a&&e.jsxs(o,{children:[c==="summary"&&A,c==="activity"&&k,c==="comments"&&t&&e.jsx(E,{entityType:"lead",entityId:t,title:"Comments"}),c==="attachments"&&t&&e.jsx(P,{entityType:"lead",entityId:t,title:"Attachments"})]}),!m&&!i&&!a&&e.jsx(o,{sx:{py:4},children:e.jsx(s,{variant:"body2",color:"text.secondary",textAlign:"center",children:"We could not find details for this lead."})})]})}export{ne as default};
//# sourceMappingURL=LeadDetail-CDxQsvwH.js.map
